import streamlit as st
import pandas as pd

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(page_title="ãƒ—ãƒ­ç«¶é¦¬åˆ†æã‚·ã‚¹ãƒ†ãƒ ", layout="wide")
st.title("ğŸ‡ ç‹¬è‡ªãƒ­ã‚¸ãƒƒã‚¯ãƒ»çš„ä¸­æœŸå¾…å€¤æ¤œç´¢")

# --- ã‚ãªãŸã®å…¨çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ ---
full_stats = {
    "ï¼¡": {
        "â‘¢": {"win": "7/17", "uren5": "11/17", "fuku": "15/23", "pop": [15,16,5,11,5,5,3,5]},
        "â‘£": {"win": "6/20", "uren5": "12/20", "fuku": "9/21", "pop": [10,12,8,5,4,6,5,2]},
        "â‘¤": {"win": "3/9", "uren5": "8/9", "fuku": "4/12", "pop": [6,10,5,4,3,1,2,2]},
    },
    "ï¼¢": {
        "â‘¢": {"win": "3/6", "uren5": "5/6", "fuku": "4/8", "pop": [6,2,4,2,3,1,3,1]},
        "â‘£": {"win": "10/19", "uren5": "9/19", "fuku": "8/20", "pop": [11,12,7,4,1,5,6,1]},
        "â‘¤": {"win": "4/13", "uren5": "7/13", "fuku": "9/15", "pop": [10,11,3,6,5,3,4,0]},
    },
    "ï¼£": {
        "â‘¢": {"win": "6/9", "uren5": "6/9", "fuku": "8/10", "pop": [9,6,5,3,1,1,1,1]},
        "â‘£": {"win": "3/7", "uren5": "4/7", "fuku": "5/11", "pop": [6,4,2,8,3,1,2,2]},
        "â‘¤": {"win": "4/6", "uren5": "4/6", "fuku": "4/8", "pop": [3,2,5,1,5,1,2,1]},
    },
    "ï¼¡ï¼¢": {
        "â‘¢": {"win": "9/13", "uren5": "12/13", "fuku": "14/17", "pop": [13,13,7,5,3,4,0,1]},
        "â‘£": {"win": "3/5", "uren5": "6/11", "fuku": "5/12", "pop": [7,8,3,4,5,4,2,1]},
        "â‘¤": {"win": "1/3", "uren5": "4/4", "fuku": "3/4", "pop": [3,1,4,1,2]},
    },
    "ï¼¡ï¼£": {
        "â‘¢": {"win": "4/13", "uren5": "2/5", "fuku": "5/8", "pop": [6,4,3,2,3,2,1,0]},
        "â‘£": {"win": "3/5", "uren5": "7/7", "fuku": "5/8", "pop": [6,3,6,3,2,3,0,0]},
        "â‘¤": {"win": "5/7", "uren5": "0/1", "fuku": "1/1", "pop": [1,0,0,0,0,0,0,0]},
    },
    "ï¼¢ï¼£": {
        "â‘¢": {"win": "1/3", "uren5": "2/3", "fuku": "4/5", "pop": [5,3,2,0,2,0,1,0]},
        "â‘£": {"win": "2/5", "uren5": "1/5", "fuku": "1/5", "pop": [2,3,2,2,1,2,0,1]},
        "â‘¤": {"win": "2/5", "uren5": "4/5", "fuku": "5/6", "pop": [5,3,3,1,1,0,0,2]},
    },
    "ãƒãƒ¼ãƒãƒ¼ã‚¯": {
        "â‘¢": {"win": "0/0", "uren5": "0/0", "fuku": "5/7", "pop": [6,6,4,2,1,2,2,0]},
        "â‘£": {"win": "0/0", "uren5": "0/0", "fuku": "8/16", "pop": [11,10,4,4,4,4,8,3]},
        "â‘¤": {"win": "0/0", "uren5": "0/0", "fuku": "7/11", "pop": [9,8,7,7,6,3,4,3]},
    }
}

# ã‚µã‚¤ãƒ‰ãƒãƒ¼è¨­å®š
target = st.sidebar.selectbox("è»¸é¦¬ã‚¿ã‚¤ãƒ—", list(full_stats.keys()))
lv = st.sidebar.radio("ãƒ¬ãƒ™ãƒ«", ["â‘¢", "â‘£", "â‘¤"])

# ãƒ¡ã‚¤ãƒ³è¡¨ç¤º
st.header(f"ğŸ“ˆ {target} Ã— {lv} ã®åˆ†æçµæœ")
data = full_stats[target][lv]

def calc_pct(frac):
    try:
        n, d = map(int, frac.split('/'))
        return f"{(n/d)*100:.1f}%" if d != 0 else "---"
    except: return "---"

c1, c2, c3 = st.columns(3)
with c1: st.metric("1ç€ã®ç¢ºç‡", calc_pct(data["win"]), data["win"])
with c2: st.metric("é¦¬é€£5äººä»¥å†…", calc_pct(data["uren5"]), data["uren5"])
with c3: st.metric("è¤‡å‹ç‡", calc_pct(data["fuku"]), data["fuku"])

st.divider()
st.subheader("ğŸ“Š äººæ°—åˆ†å¸ƒã‚°ãƒ©ãƒ•")
pop_chart = pd.DataFrame({"äººæ°—": [f"{i+1}äºº" for i in range(len(data["pop"]))], "å›æ•°": data["pop"]})
st.bar_chart(pop_chart, x="äººæ°—", y="å›æ•°")

st.divider()
pt_val = {"ï¼¡": "20/33", "ï¼¢": "19/25", "ï¼£": "11/21", "ï¼¡ï¼¢": "21/27", "ï¼¡ï¼£": "11/14", "ï¼¢ï¼£": "8/15", "ï¼¡ï¼¢ï¼£": "7/6", "ãƒãƒ¼ãƒãƒ¼ã‚¯": "14/20"}.get(target, "---")
idx_val = {"ï¼¡": "26/58", "ï¼¢": "15/31", "ï¼£": "11/20", "ï¼¡ï¼¢": "28/37", "ï¼¡ï¼£": "13/15", "ï¼¢ï¼£": "14/20", "ï¼¡ï¼¢ï¼£": "3/8", "ãƒãƒ¼ãƒãƒ¼ã‚¯": "10/27"}.get(target, "---")
st.write(f"### ğŸ PT: **{pt_val}** | ğŸ¯ ç‹¬è‡ªæŒ‡æ•°: **{idx_val}**")
